<?php/** * @package     Joomla.Plugin * @subpackage  Content.lazyTube * * * @license     GNU General Public License version 2 or later; see LICENSE.txt */defined('_JEXEC') or die;/** * Plugin to enable loading modules into content (e.g. articles) * This uses the {loadvideo} syntax * * */class PlgContentLazytube extends JPlugin{	public function onContentPrepare($context, &$article, &$params, $page = 0) {		// Don't run this plugin when the content is being indexed		if ($context === 'com_finder.indexer'):			return true;		endif;		if(strpos($article->text, 'loadvideo') === false):			return true;		else:			$document = JFactory::getDocument();			$document->addStyleSheet('/plugins/content/lazytube/assets/lazy-tube-styles.css');			$document->addScript('/plugins/content/lazytube/assets/lazy-tube-scripts.js', [], ['defer' => 'defer']);		endif;		$regex_video_settings = '/(?<={loadvideo\s)(.*)(?=})/i';		preg_match_all($regex_video_settings, $article->text, $matches);		foreach ($matches[0] as $index => $match) :			$params_list[explode(' ', $match)[0]] = explode(' ', $match)[1];		endforeach;		foreach ($params_list as $id => $res) :			$pattern = '/{loadvideo '.$id.' '.$res.'}/i';			$replacement = '								<div class="video">								<a class="video-link" data-src="'.$id.'">										<img class="video-media" src="https://img.youtube.com/vi/'.$id.'/'.$res.'default.jpg" alt="">									</a>				<button class="video-button">					<svg width="65" height="60" viewBox="0 0 65 60">						<path class="button-shape" d="M63,14.87c-0.72-2.7-2.85-4.83-5.56-5.56C52.54,8,32.88,8,32.88,8S13.23,8,8.32,9.31				            c-2.7,0.72-4.83,2.85-5.56,5.56C1.45,19.77,1.45,30,1.45,30s0,10.23,1.31,15.13c0.72,2.7,2.85,4.83,5.56,5.56				            C13.23,52,32.88,52,32.88,52s19.66,0,24.56-1.31c2.7-0.72,4.83-2.85,5.56-5.56C64.31,40.23,64.31,30,64.31,30				            S64.31,19.77,63,14.87z" class="style-scope ytd-topbar-logo-renderer">				        </path>				        <polygon fill="#FFFFFF" points="26.6,39.43 42.93,30 26.6,20.57" class="style-scope ytd-topbar-logo-renderer"></polygon>					</svg>				</button>			</div>';			$article->text = preg_replace($pattern, $replacement, $article->text);		endforeach;	}}